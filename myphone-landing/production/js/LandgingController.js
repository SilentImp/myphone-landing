var LandgingController,
  __bind = function(fn, me) {
    return function() {
      return fn.apply(me, arguments);
    };
  };

LandgingController = (function() {
  function LandgingController() {
    this.trysubmit = __bind(this.trysubmit, this);
    this.formSend = __bind(this.formSend, this);
    this.submit = __bind(this.submit, this);
    this.selectLanguage = __bind(this.selectLanguage, this);
    this.timerUpdate = __bind(this.timerUpdate, this);
    this.codeChange = __bind(this.codeChange, this);
    this.codeSelectChange = __bind(this.codeSelectChange, this);
    this.closeRules = __bind(this.closeRules, this);
    this.showRules = __bind(this.showRules, this);
    this.ip2Country = __bind(this.ip2Country, this);
    this.itype = 'click';
    this.html = $('html');
    if (this.html.hasClass('touch')) {
      this.itype = 'touchstart';
    }
    this.form = $('.register-form');
    this.timer = $('.time');
    this.ti = 0;
    window.setInterval(this.timerUpdate, 1000);
    this.timerUpdate();
    this.form.find('.code-widget input').on('change', this.codeChange);
    this.form.find('select').on('change', this.codeSelectChange);
    this.form.find('input.tel').mask("(999) 999-99-99");
    this.form.find('input.code').mask("+9?999");
    $('.rules .close').on(this.itype, this.closeRules);
    $('.show-rules').on(this.itype, this.showRules);
    this.message = this.form.prev();
    this.lang = $('nav.language');
    this.lang.on(this.itype, this.selectLanguage);
    this.lang.find('a').on(this.itype, this.selectLanguage);
    this.form.find('button').on(this.itype, this.trysubmit);
    this.form.on('submit', this.submit);
    this.language = localStorage.language || null;
    if (this.language === null) {
      $.getJSON("http://www.telize.com/geoip", this.ip2Country);
    } else if (this.language === 'AZ') {
      this.lang.find('a').trigger('click');
    }
  }

  LandgingController.prototype.ip2Country = function(obj) {
    switch (obj.country_code) {
      case 'AZ':
        this.language = 'AZ';
        this.lang.find('a').trigger('click');
        break;
      default:
        this.language = 'RU';
    }
    return localStorage.language = this.language;
  };

  LandgingController.prototype.showRules = function(event) {
    event.preventDefault();
    this.html.addClass('rules');
    $(event.currentTarget).closest('.page').find('.rules').show();
    return window.scrollTo(0, 0);
  };

  LandgingController.prototype.closeRules = function(event) {
    this.html.removeClass('rules');
    $(event.currentTarget.parentNode).hide();
    return window.scrollTo(0, 0);
  };

  LandgingController.prototype.codeSelectChange = function(event) {
    var current, element, value, wrapper;
    element = $(event.currentTarget);
    value = element.val();
    wrapper = element.closest('.code-widget');
    current = wrapper.find('.current .value');
    current.text(value);
    return wrapper.find('input[type="radio"][name="code"][value="' + value + '"]').trigger('click');
  };

  LandgingController.prototype.codeChange = function(event) {
    var current, element, wrapper;
    element = $(event.currentTarget);
    wrapper = element.closest('.code-widget');
    current = wrapper.find('.current .value');
    current.text(element.val());
    wrapper.addClass('changed');
    return window.setTimeout(function() {
      return wrapper.removeClass('changed');
    }, 500);
  };

  LandgingController.prototype.timerUpdate = function() {
    var sepator;
    if ((this.ti % 2) === 0) {
      sepator = ":";
    } else {
      sepator = "Â ";
    }
    this.ti++;
    return this.timer.text(moment().format("HH" + sepator + "mm"));
  };

  LandgingController.prototype.selectLanguage = function(event) {
    event.preventDefault();
    event.stopPropagation();
    this.lang.find('a').toggleClass('selected');
    this.language = this.lang.find('.selected').attr('data-lang');
    localStorage.language = this.language;
    return this.html.attr('lang', this.language);
  };

  LandgingController.prototype.submit = function(event) {
    var form;
    event.preventDefault();
    form = $(event.currentTarget);
    return $.post(form.attr('action'), form.serialize()).complete(this.formSend);
  };

  LandgingController.prototype.formSend = function(responce) {
    this.form.hide();
    return this.message.show();
  };

  LandgingController.prototype.trysubmit = function(event) {
    var button, form;
    button = $(event.currentTarget);
    form = button.closest('form.register-form');
    return form.addClass('validation-start');
  };

  return LandgingController;

})();

$(document).ready(function() {
  return document.landing = new LandgingController();
});

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkxhbmRnaW5nQ29udHJvbGxlci5jb2ZmZWUiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsSUFBQSxrQkFBQTtFQUFBLGtGQUFBOztBQUFBO0FBQ2UsRUFBQSw0QkFBQSxHQUFBO0FBRVgsaURBQUEsQ0FBQTtBQUFBLCtDQUFBLENBQUE7QUFBQSwyQ0FBQSxDQUFBO0FBQUEsMkRBQUEsQ0FBQTtBQUFBLHFEQUFBLENBQUE7QUFBQSxtREFBQSxDQUFBO0FBQUEsK0RBQUEsQ0FBQTtBQUFBLG1EQUFBLENBQUE7QUFBQSxpREFBQSxDQUFBO0FBQUEsbURBQUEsQ0FBQTtBQUFBLElBQUEsSUFBQyxDQUFBLEtBQUQsR0FBUyxPQUFULENBQUE7QUFBQSxJQUNBLElBQUMsQ0FBQSxJQUFELEdBQVEsQ0FBQSxDQUFFLE1BQUYsQ0FEUixDQUFBO0FBRUEsSUFBQSxJQUFHLElBQUMsQ0FBQSxJQUFJLENBQUMsUUFBTixDQUFlLE9BQWYsQ0FBSDtBQUNFLE1BQUEsSUFBQyxDQUFBLEtBQUQsR0FBUyxZQUFULENBREY7S0FGQTtBQUFBLElBS0EsSUFBQyxDQUFBLElBQUQsR0FBUSxDQUFBLENBQUUsZ0JBQUYsQ0FMUixDQUFBO0FBQUEsSUFPQSxJQUFDLENBQUEsS0FBRCxHQUFTLENBQUEsQ0FBRSxPQUFGLENBUFQsQ0FBQTtBQUFBLElBUUEsSUFBQyxDQUFBLEVBQUQsR0FBTSxDQVJOLENBQUE7QUFBQSxJQVNBLE1BQU0sQ0FBQyxXQUFQLENBQW1CLElBQUMsQ0FBQSxXQUFwQixFQUFpQyxJQUFqQyxDQVRBLENBQUE7QUFBQSxJQVVBLElBQUMsQ0FBQSxXQUFELENBQUEsQ0FWQSxDQUFBO0FBQUEsSUFZQSxJQUFDLENBQUEsSUFBSSxDQUFDLElBQU4sQ0FBVyxvQkFBWCxDQUFnQyxDQUFDLEVBQWpDLENBQW9DLFFBQXBDLEVBQThDLElBQUMsQ0FBQSxVQUEvQyxDQVpBLENBQUE7QUFBQSxJQWFBLElBQUMsQ0FBQSxJQUFJLENBQUMsSUFBTixDQUFXLFFBQVgsQ0FBb0IsQ0FBQyxFQUFyQixDQUF3QixRQUF4QixFQUFrQyxJQUFDLENBQUEsZ0JBQW5DLENBYkEsQ0FBQTtBQUFBLElBZUEsSUFBQyxDQUFBLElBQUksQ0FBQyxJQUFOLENBQVcsV0FBWCxDQUF1QixDQUFDLElBQXhCLENBQTZCLGlCQUE3QixDQWZBLENBQUE7QUFBQSxJQWdCQSxJQUFDLENBQUEsSUFBSSxDQUFDLElBQU4sQ0FBVyxZQUFYLENBQXdCLENBQUMsSUFBekIsQ0FBOEIsUUFBOUIsQ0FoQkEsQ0FBQTtBQUFBLElBa0JBLENBQUEsQ0FBRSxlQUFGLENBQWtCLENBQUMsRUFBbkIsQ0FBc0IsSUFBQyxDQUFBLEtBQXZCLEVBQThCLElBQUMsQ0FBQSxVQUEvQixDQWxCQSxDQUFBO0FBQUEsSUFtQkEsQ0FBQSxDQUFFLGFBQUYsQ0FBZ0IsQ0FBQyxFQUFqQixDQUFvQixJQUFDLENBQUEsS0FBckIsRUFBNEIsSUFBQyxDQUFBLFNBQTdCLENBbkJBLENBQUE7QUFBQSxJQXNCQSxJQUFDLENBQUEsT0FBRCxHQUFXLElBQUksQ0FBQyxJQUFJLENBQUMsSUFBVixDQUFBLENBdEJYLENBQUE7QUFBQSxJQXdCQSxJQUFDLENBQUEsSUFBRCxHQUFRLENBQUEsQ0FBRSxjQUFGLENBeEJSLENBQUE7QUFBQSxJQXlCQSxJQUFDLENBQUEsSUFBSSxDQUFDLEVBQU4sQ0FBUyxJQUFJLENBQUMsS0FBZCxFQUFxQixJQUFDLENBQUEsY0FBdEIsQ0F6QkEsQ0FBQTtBQUFBLElBMEJBLElBQUMsQ0FBQSxJQUFJLENBQUMsSUFBTixDQUFXLEdBQVgsQ0FBZSxDQUFDLEVBQWhCLENBQW1CLElBQUksQ0FBQyxLQUF4QixFQUErQixJQUFDLENBQUEsY0FBaEMsQ0ExQkEsQ0FBQTtBQUFBLElBNEJBLElBQUMsQ0FBQSxJQUFJLENBQUMsSUFBTixDQUFXLFFBQVgsQ0FBb0IsQ0FBQyxFQUFyQixDQUF3QixJQUFJLENBQUMsS0FBN0IsRUFBb0MsSUFBQyxDQUFBLFNBQXJDLENBNUJBLENBQUE7QUFBQSxJQTZCQSxJQUFDLENBQUEsSUFBSSxDQUFDLEVBQU4sQ0FBUyxRQUFULEVBQW1CLElBQUMsQ0FBQSxNQUFwQixDQTdCQSxDQUFBO0FBQUEsSUErQkEsSUFBQyxDQUFBLFFBQUQsR0FBWSxZQUFZLENBQUMsUUFBYixJQUF5QixJQS9CckMsQ0FBQTtBQWlDQSxJQUFBLElBQUcsSUFBQyxDQUFBLFFBQUQsS0FBYSxJQUFoQjtBQUNFLE1BQUEsQ0FBQyxDQUFDLE9BQUYsQ0FBVSw2QkFBVixFQUF5QyxJQUFDLENBQUEsVUFBMUMsQ0FBQSxDQURGO0tBQUEsTUFFSyxJQUFHLElBQUMsQ0FBQSxRQUFELEtBQWEsSUFBaEI7QUFDSCxNQUFBLElBQUMsQ0FBQSxJQUFJLENBQUMsSUFBTixDQUFXLEdBQVgsQ0FBZSxDQUFDLE9BQWhCLENBQXdCLE9BQXhCLENBQUEsQ0FERztLQXJDTTtFQUFBLENBQWI7O0FBQUEsK0JBd0NBLFVBQUEsR0FBWSxTQUFDLEdBQUQsR0FBQTtBQUNWLFlBQU8sR0FBRyxDQUFDLFlBQVg7QUFBQSxXQUNPLElBRFA7QUFFSSxRQUFBLElBQUMsQ0FBQSxRQUFELEdBQVksSUFBWixDQUFBO0FBQUEsUUFDQSxJQUFDLENBQUEsSUFBSSxDQUFDLElBQU4sQ0FBVyxHQUFYLENBQWUsQ0FBQyxPQUFoQixDQUF3QixPQUF4QixDQURBLENBRko7QUFDTztBQURQO0FBS0ksUUFBQSxJQUFDLENBQUEsUUFBRCxHQUFZLElBQVosQ0FMSjtBQUFBLEtBQUE7V0FNQSxZQUFZLENBQUMsUUFBYixHQUF3QixJQUFDLENBQUEsU0FQZjtFQUFBLENBeENaLENBQUE7O0FBQUEsK0JBaURBLFNBQUEsR0FBVyxTQUFDLEtBQUQsR0FBQTtBQUNULElBQUEsS0FBSyxDQUFDLGNBQU4sQ0FBQSxDQUFBLENBQUE7QUFBQSxJQUNBLElBQUMsQ0FBQSxJQUFJLENBQUMsUUFBTixDQUFlLE9BQWYsQ0FEQSxDQUFBO0FBQUEsSUFFQSxDQUFBLENBQUUsS0FBSyxDQUFDLGFBQVIsQ0FBc0IsQ0FBQyxPQUF2QixDQUErQixPQUEvQixDQUF1QyxDQUFDLElBQXhDLENBQTZDLFFBQTdDLENBQXNELENBQUMsSUFBdkQsQ0FBQSxDQUZBLENBQUE7V0FHQSxNQUFNLENBQUMsUUFBUCxDQUFnQixDQUFoQixFQUFtQixDQUFuQixFQUpTO0VBQUEsQ0FqRFgsQ0FBQTs7QUFBQSwrQkF1REEsVUFBQSxHQUFZLFNBQUMsS0FBRCxHQUFBO0FBQ1YsSUFBQSxJQUFDLENBQUEsSUFBSSxDQUFDLFdBQU4sQ0FBa0IsT0FBbEIsQ0FBQSxDQUFBO0FBQUEsSUFDQSxDQUFBLENBQUUsS0FBSyxDQUFDLGFBQWEsQ0FBQyxVQUF0QixDQUFpQyxDQUFDLElBQWxDLENBQUEsQ0FEQSxDQUFBO1dBRUEsTUFBTSxDQUFDLFFBQVAsQ0FBZ0IsQ0FBaEIsRUFBbUIsQ0FBbkIsRUFIVTtFQUFBLENBdkRaLENBQUE7O0FBQUEsK0JBNERBLGdCQUFBLEdBQWtCLFNBQUMsS0FBRCxHQUFBO0FBQ2hCLFFBQUEsZ0NBQUE7QUFBQSxJQUFBLE9BQUEsR0FBVSxDQUFBLENBQUUsS0FBSyxDQUFDLGFBQVIsQ0FBVixDQUFBO0FBQUEsSUFDQSxLQUFBLEdBQVEsT0FBTyxDQUFDLEdBQVIsQ0FBQSxDQURSLENBQUE7QUFBQSxJQUVBLE9BQUEsR0FBVSxPQUFPLENBQUMsT0FBUixDQUFnQixjQUFoQixDQUZWLENBQUE7QUFBQSxJQUdBLE9BQUEsR0FBVSxPQUFPLENBQUMsSUFBUixDQUFhLGlCQUFiLENBSFYsQ0FBQTtBQUFBLElBSUEsT0FBTyxDQUFDLElBQVIsQ0FBYSxLQUFiLENBSkEsQ0FBQTtXQUtBLE9BQU8sQ0FBQyxJQUFSLENBQWEsMENBQUEsR0FBMkMsS0FBM0MsR0FBaUQsSUFBOUQsQ0FBbUUsQ0FBQyxPQUFwRSxDQUE0RSxPQUE1RSxFQU5nQjtFQUFBLENBNURsQixDQUFBOztBQUFBLCtCQW9FQSxVQUFBLEdBQVksU0FBQyxLQUFELEdBQUE7QUFDVixRQUFBLHlCQUFBO0FBQUEsSUFBQSxPQUFBLEdBQVUsQ0FBQSxDQUFFLEtBQUssQ0FBQyxhQUFSLENBQVYsQ0FBQTtBQUFBLElBQ0EsT0FBQSxHQUFVLE9BQU8sQ0FBQyxPQUFSLENBQWdCLGNBQWhCLENBRFYsQ0FBQTtBQUFBLElBRUEsT0FBQSxHQUFVLE9BQU8sQ0FBQyxJQUFSLENBQWEsaUJBQWIsQ0FGVixDQUFBO0FBQUEsSUFHQSxPQUFPLENBQUMsSUFBUixDQUFhLE9BQU8sQ0FBQyxHQUFSLENBQUEsQ0FBYixDQUhBLENBQUE7QUFBQSxJQUlBLE9BQU8sQ0FBQyxRQUFSLENBQWlCLFNBQWpCLENBSkEsQ0FBQTtXQUtBLE1BQU0sQ0FBQyxVQUFQLENBQWtCLFNBQUEsR0FBQTthQUNoQixPQUFPLENBQUMsV0FBUixDQUFvQixTQUFwQixFQURnQjtJQUFBLENBQWxCLEVBRUUsR0FGRixFQU5VO0VBQUEsQ0FwRVosQ0FBQTs7QUFBQSwrQkErRUEsV0FBQSxHQUFhLFNBQUEsR0FBQTtBQUNYLFFBQUEsT0FBQTtBQUFBLElBQUEsSUFBRyxDQUFDLElBQUMsQ0FBQSxFQUFELEdBQUksQ0FBTCxDQUFBLEtBQVMsQ0FBWjtBQUNFLE1BQUEsT0FBQSxHQUFVLEdBQVYsQ0FERjtLQUFBLE1BQUE7QUFHRSxNQUFBLE9BQUEsR0FBVSxHQUFWLENBSEY7S0FBQTtBQUFBLElBSUEsSUFBQyxDQUFBLEVBQUQsRUFKQSxDQUFBO1dBS0EsSUFBQyxDQUFBLEtBQUssQ0FBQyxJQUFQLENBQVksTUFBQSxDQUFBLENBQVEsQ0FBQyxNQUFULENBQWdCLElBQUEsR0FBSyxPQUFMLEdBQWEsSUFBN0IsQ0FBWixFQU5XO0VBQUEsQ0EvRWIsQ0FBQTs7QUFBQSwrQkF1RkEsY0FBQSxHQUFnQixTQUFDLEtBQUQsR0FBQTtBQUNkLElBQUEsS0FBSyxDQUFDLGNBQU4sQ0FBQSxDQUFBLENBQUE7QUFBQSxJQUNBLEtBQUssQ0FBQyxlQUFOLENBQUEsQ0FEQSxDQUFBO0FBQUEsSUFFQSxJQUFDLENBQUEsSUFBSSxDQUFDLElBQU4sQ0FBVyxHQUFYLENBQWUsQ0FBQyxXQUFoQixDQUE0QixVQUE1QixDQUZBLENBQUE7QUFBQSxJQUdBLElBQUMsQ0FBQSxRQUFELEdBQVksSUFBQyxDQUFBLElBQUksQ0FBQyxJQUFOLENBQVcsV0FBWCxDQUF1QixDQUFDLElBQXhCLENBQTZCLFdBQTdCLENBSFosQ0FBQTtBQUFBLElBSUEsWUFBWSxDQUFDLFFBQWIsR0FBd0IsSUFBQyxDQUFBLFFBSnpCLENBQUE7V0FLQSxJQUFDLENBQUEsSUFBSSxDQUFDLElBQU4sQ0FBVyxNQUFYLEVBQW1CLElBQUMsQ0FBQSxRQUFwQixFQU5jO0VBQUEsQ0F2RmhCLENBQUE7O0FBQUEsK0JBK0ZBLE1BQUEsR0FBUSxTQUFDLEtBQUQsR0FBQTtBQUNOLFFBQUEsSUFBQTtBQUFBLElBQUEsS0FBSyxDQUFDLGNBQU4sQ0FBQSxDQUFBLENBQUE7QUFBQSxJQUNBLElBQUEsR0FBTyxDQUFBLENBQUUsS0FBSyxDQUFDLGFBQVIsQ0FEUCxDQUFBO1dBRUEsQ0FBQyxDQUFDLElBQUYsQ0FBTyxJQUFJLENBQUMsSUFBTCxDQUFVLFFBQVYsQ0FBUCxFQUE0QixJQUFJLENBQUMsU0FBTCxDQUFBLENBQTVCLENBQTZDLENBQUMsUUFBOUMsQ0FBdUQsSUFBQyxDQUFBLFFBQXhELEVBSE07RUFBQSxDQS9GUixDQUFBOztBQUFBLCtCQW9HQSxRQUFBLEdBQVUsU0FBQyxRQUFELEdBQUE7QUFDUixJQUFBLElBQUMsQ0FBQSxJQUFJLENBQUMsSUFBTixDQUFBLENBQUEsQ0FBQTtXQUNBLElBQUMsQ0FBQSxPQUFPLENBQUMsSUFBVCxDQUFBLEVBRlE7RUFBQSxDQXBHVixDQUFBOztBQUFBLCtCQXdHQSxTQUFBLEdBQVcsU0FBQyxLQUFELEdBQUE7QUFDVCxRQUFBLFlBQUE7QUFBQSxJQUFBLE1BQUEsR0FBUyxDQUFBLENBQUUsS0FBSyxDQUFDLGFBQVIsQ0FBVCxDQUFBO0FBQUEsSUFDQSxJQUFBLEdBQU8sTUFBTSxDQUFDLE9BQVAsQ0FBZSxvQkFBZixDQURQLENBQUE7V0FFQSxJQUFJLENBQUMsUUFBTCxDQUFjLGtCQUFkLEVBSFM7RUFBQSxDQXhHWCxDQUFBOzs0QkFBQTs7SUFERixDQUFBOztBQUFBLENBK0dBLENBQUUsUUFBRixDQUFXLENBQUMsS0FBWixDQUFrQixTQUFBLEdBQUE7U0FDaEIsUUFBUSxDQUFDLE9BQVQsR0FBdUIsSUFBQSxrQkFBQSxDQUFBLEVBRFA7QUFBQSxDQUFsQixDQS9HQSxDQUFBIiwiZmlsZSI6IkxhbmRnaW5nQ29udHJvbGxlci5qcyIsInNvdXJjZVJvb3QiOiIvc291cmNlLyIsInNvdXJjZXNDb250ZW50IjpbImNsYXNzIExhbmRnaW5nQ29udHJvbGxlclxuICBjb25zdHJ1Y3RvcjogLT5cblxuICAgIEBpdHlwZSA9ICdjbGljayc7XG4gICAgQGh0bWwgPSAkICdodG1sJ1xuICAgIGlmIEBodG1sLmhhc0NsYXNzKCd0b3VjaCcpXG4gICAgICBAaXR5cGUgPSAndG91Y2hzdGFydCdcblxuICAgIEBmb3JtID0gJCgnLnJlZ2lzdGVyLWZvcm0nKVxuICAgIFxuICAgIEB0aW1lciA9ICQoJy50aW1lJylcbiAgICBAdGkgPSAwXG4gICAgd2luZG93LnNldEludGVydmFsIEB0aW1lclVwZGF0ZSwgMTAwMFxuICAgIEB0aW1lclVwZGF0ZSgpXG5cbiAgICBAZm9ybS5maW5kKCcuY29kZS13aWRnZXQgaW5wdXQnKS5vbiAnY2hhbmdlJywgQGNvZGVDaGFuZ2VcbiAgICBAZm9ybS5maW5kKCdzZWxlY3QnKS5vbiAnY2hhbmdlJywgQGNvZGVTZWxlY3RDaGFuZ2VcblxuICAgIEBmb3JtLmZpbmQoJ2lucHV0LnRlbCcpLm1hc2sgXCIoOTk5KSA5OTktOTktOTlcIlxuICAgIEBmb3JtLmZpbmQoJ2lucHV0LmNvZGUnKS5tYXNrIFwiKzk/OTk5XCJcblxuICAgICQoJy5ydWxlcyAuY2xvc2UnKS5vbiBAaXR5cGUsIEBjbG9zZVJ1bGVzXG4gICAgJCgnLnNob3ctcnVsZXMnKS5vbiBAaXR5cGUsIEBzaG93UnVsZXNcbiAgICBcbiAgICBcbiAgICBAbWVzc2FnZSA9IHRoaXMuZm9ybS5wcmV2KClcblxuICAgIEBsYW5nID0gJCAnbmF2Lmxhbmd1YWdlJ1xuICAgIEBsYW5nLm9uIHRoaXMuaXR5cGUsIEBzZWxlY3RMYW5ndWFnZVxuICAgIEBsYW5nLmZpbmQoJ2EnKS5vbiB0aGlzLml0eXBlLCBAc2VsZWN0TGFuZ3VhZ2VcblxuICAgIEBmb3JtLmZpbmQoJ2J1dHRvbicpLm9uIHRoaXMuaXR5cGUsIEB0cnlzdWJtaXRcbiAgICBAZm9ybS5vbiAnc3VibWl0JywgQHN1Ym1pdFxuXG4gICAgQGxhbmd1YWdlID0gbG9jYWxTdG9yYWdlLmxhbmd1YWdlIHx8IG51bGxcblxuICAgIGlmIEBsYW5ndWFnZSA9PSBudWxsXG4gICAgICAkLmdldEpTT04oXCJodHRwOi8vd3d3LnRlbGl6ZS5jb20vZ2VvaXBcIiwgQGlwMkNvdW50cnkpXG4gICAgZWxzZSBpZiBAbGFuZ3VhZ2UgPT0gJ0FaJ1xuICAgICAgQGxhbmcuZmluZCgnYScpLnRyaWdnZXIgJ2NsaWNrJ1xuXG4gIGlwMkNvdW50cnk6IChvYmopPT5cbiAgICBzd2l0Y2ggb2JqLmNvdW50cnlfY29kZVxuICAgICAgd2hlbiAnQVonIFxuICAgICAgICBAbGFuZ3VhZ2UgPSAnQVonXG4gICAgICAgIEBsYW5nLmZpbmQoJ2EnKS50cmlnZ2VyICdjbGljaydcbiAgICAgIGVsc2VcbiAgICAgICAgQGxhbmd1YWdlID0gJ1JVJ1xuICAgIGxvY2FsU3RvcmFnZS5sYW5ndWFnZSA9IEBsYW5ndWFnZVxuXG4gIHNob3dSdWxlczogKGV2ZW50KT0+XG4gICAgZXZlbnQucHJldmVudERlZmF1bHQoKVxuICAgIEBodG1sLmFkZENsYXNzICdydWxlcydcbiAgICAkKGV2ZW50LmN1cnJlbnRUYXJnZXQpLmNsb3Nlc3QoJy5wYWdlJykuZmluZCgnLnJ1bGVzJykuc2hvdygpXG4gICAgd2luZG93LnNjcm9sbFRvIDAsIDBcblxuICBjbG9zZVJ1bGVzOiAoZXZlbnQpPT5cbiAgICBAaHRtbC5yZW1vdmVDbGFzcyAncnVsZXMnXG4gICAgJChldmVudC5jdXJyZW50VGFyZ2V0LnBhcmVudE5vZGUpLmhpZGUoKVxuICAgIHdpbmRvdy5zY3JvbGxUbyAwLCAwXG4gICAgXG4gIGNvZGVTZWxlY3RDaGFuZ2U6IChldmVudCk9PlxuICAgIGVsZW1lbnQgPSAkIGV2ZW50LmN1cnJlbnRUYXJnZXRcbiAgICB2YWx1ZSA9IGVsZW1lbnQudmFsKClcbiAgICB3cmFwcGVyID0gZWxlbWVudC5jbG9zZXN0KCcuY29kZS13aWRnZXQnKVxuICAgIGN1cnJlbnQgPSB3cmFwcGVyLmZpbmQoJy5jdXJyZW50IC52YWx1ZScpXG4gICAgY3VycmVudC50ZXh0IHZhbHVlXG4gICAgd3JhcHBlci5maW5kKCdpbnB1dFt0eXBlPVwicmFkaW9cIl1bbmFtZT1cImNvZGVcIl1bdmFsdWU9XCInK3ZhbHVlKydcIl0nKS50cmlnZ2VyICdjbGljaydcblxuICBjb2RlQ2hhbmdlOiAoZXZlbnQpPT5cbiAgICBlbGVtZW50ID0gJCBldmVudC5jdXJyZW50VGFyZ2V0XG4gICAgd3JhcHBlciA9IGVsZW1lbnQuY2xvc2VzdCgnLmNvZGUtd2lkZ2V0JylcbiAgICBjdXJyZW50ID0gd3JhcHBlci5maW5kKCcuY3VycmVudCAudmFsdWUnKVxuICAgIGN1cnJlbnQudGV4dChlbGVtZW50LnZhbCgpKVxuICAgIHdyYXBwZXIuYWRkQ2xhc3MgJ2NoYW5nZWQnXG4gICAgd2luZG93LnNldFRpbWVvdXQoKCktPlxuICAgICAgd3JhcHBlci5yZW1vdmVDbGFzcyAnY2hhbmdlZCdcbiAgICAsIDUwMClcblxuXG4gIHRpbWVyVXBkYXRlOiA9PlxuICAgIGlmIChAdGklMik9PTBcbiAgICAgIHNlcGF0b3IgPSBcIjpcIlxuICAgIGVsc2VcbiAgICAgIHNlcGF0b3IgPSBcIsKgXCJcbiAgICBAdGkrK1xuICAgIEB0aW1lci50ZXh0KG1vbWVudCgpLmZvcm1hdChcIkhIXCIrc2VwYXRvcitcIm1tXCIpKVxuXG4gIHNlbGVjdExhbmd1YWdlOiAoZXZlbnQpPT5cbiAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpXG4gICAgZXZlbnQuc3RvcFByb3BhZ2F0aW9uKClcbiAgICBAbGFuZy5maW5kKCdhJykudG9nZ2xlQ2xhc3MgJ3NlbGVjdGVkJ1xuICAgIEBsYW5ndWFnZSA9IEBsYW5nLmZpbmQoJy5zZWxlY3RlZCcpLmF0dHIoJ2RhdGEtbGFuZycpXG4gICAgbG9jYWxTdG9yYWdlLmxhbmd1YWdlID0gQGxhbmd1YWdlXG4gICAgQGh0bWwuYXR0ciAnbGFuZycsIEBsYW5ndWFnZVxuXG4gIHN1Ym1pdDogKGV2ZW50KT0+XG4gICAgZXZlbnQucHJldmVudERlZmF1bHQoKVxuICAgIGZvcm0gPSAkIGV2ZW50LmN1cnJlbnRUYXJnZXRcbiAgICAkLnBvc3QoZm9ybS5hdHRyKCdhY3Rpb24nKSwgZm9ybS5zZXJpYWxpemUoKSkuY29tcGxldGUoQGZvcm1TZW5kKVxuXG4gIGZvcm1TZW5kOiAocmVzcG9uY2UpPT5cbiAgICBAZm9ybS5oaWRlKClcbiAgICBAbWVzc2FnZS5zaG93KClcblxuICB0cnlzdWJtaXQ6IChldmVudCk9PlxuICAgIGJ1dHRvbiA9ICQgZXZlbnQuY3VycmVudFRhcmdldFxuICAgIGZvcm0gPSBidXR0b24uY2xvc2VzdCgnZm9ybS5yZWdpc3Rlci1mb3JtJylcbiAgICBmb3JtLmFkZENsYXNzKCd2YWxpZGF0aW9uLXN0YXJ0JylcblxuXG4kKGRvY3VtZW50KS5yZWFkeSAoKS0+XG4gIGRvY3VtZW50LmxhbmRpbmcgPSBuZXcgTGFuZGdpbmdDb250cm9sbGVyKCkiXX0=