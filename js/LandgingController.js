var LandgingController,
  __bind = function(fn, me) {
    return function() {
      return fn.apply(me, arguments);
    };
  };

LandgingController = (function() {
  function LandgingController() {
    this.trysubmit = __bind(this.trysubmit, this);
    this.formSend = __bind(this.formSend, this);
    this.submit = __bind(this.submit, this);
    this.selectLanguage = __bind(this.selectLanguage, this);
    this.timerUpdate = __bind(this.timerUpdate, this);
    this.closeRules = __bind(this.closeRules, this);
    this.showRules = __bind(this.showRules, this);
    this.ip2Country = __bind(this.ip2Country, this);
    this.itype = 'click';
    this.html = $('html');
    if (this.html.hasClass('touch')) {
      this.itype = 'touchstart';
    }
    this.form = $('.register-form');
    this.timer = $('.time');
    this.ti = 0;
    window.setInterval(this.timerUpdate, 1000);
    this.timerUpdate();
    this.form.find('input.tel').mask("(999) 999-99-99");
    this.form.find('input.code').mask("+9?999");
    $('.rules .close').on(this.itype, this.closeRules);
    $('.show-rules').on(this.itype, this.showRules);
    this.message = this.form.prev();
    this.lang = $('nav.language');
    this.lang.on(this.itype, this.selectLanguage);
    this.lang.find('a').on(this.itype, this.selectLanguage);
    this.form.find('button').on(this.itype, this.trysubmit);
    this.form.on('submit', this.submit);
    this.language = localStorage.language || null;
    if (this.language === null) {
      $.getJSON("http://www.telize.com/geoip", this.ip2Country);
    } else if (this.language === 'AZ') {
      console.log('turn on AZ');
      this.lang.trigger(this.itype);
    }
  }

  LandgingController.prototype.ip2Country = function(obj) {
    switch (obj.country_code) {
      case 'AZ':
        this.language = 'AZ';
        this.lang.trigger(this.itype);
        break;
      default:
        this.language = 'RU';
    }
    return localStorage.language = this.language;
  };

  LandgingController.prototype.showRules = function(event) {
    event.preventDefault();
    event.stopPropagation();
    if (event.gesture) {
      event.gesture.stopPropagation();
      event.gesture.preventDefault();
    }
    this.html.addClass('rules');
    $(event.currentTarget).closest('.page').find('.rules').show();
    window.scrollTo(0, 0);
    return false;
  };

  LandgingController.prototype.closeRules = function(event) {
    event.preventDefault();
    event.stopPropagation();
    if (event.gesture) {
      event.gesture.stopPropagation();
      event.gesture.preventDefault();
    }
    this.html.removeClass('rules');
    $(event.currentTarget.parentNode).hide();
    window.scrollTo(0, 0);
    return false;
  };

  LandgingController.prototype.timerUpdate = function() {
    var sepator;
    if ((this.ti % 2) === 0) {
      sepator = ":";
    } else {
      sepator = "Â ";
    }
    this.ti++;
    return this.timer.text(moment().format("HH" + sepator + "mm"));
  };

  LandgingController.prototype.selectLanguage = function(event) {
    event.preventDefault();
    event.stopPropagation();
    if (event.gesture) {
      event.gesture.stopPropagation();
      event.gesture.preventDefault();
    }
    this.lang.find('a').toggleClass('selected');
    this.language = this.lang.find('.selected').attr('data-lang');
    localStorage.language = this.language;
    this.html.attr('lang', this.language);
    return false;
  };

  LandgingController.prototype.submit = function(event) {
    var form;
    event.preventDefault();
    event.stopPropagation();
    if (event.gesture) {
      event.gesture.stopPropagation();
      event.gesture.preventDefault();
    }
    form = $(event.currentTarget);
    if (form.find('input:invalid').length === 0) {
      $.post(form.attr('action'), form.serialize()).complete(this.formSend);
    }
    return false;
  };

  LandgingController.prototype.formSend = function(responce) {
    this.form.hide();
    return this.message.show();
  };

  LandgingController.prototype.trysubmit = function(event) {
    var button, form;
    button = $(event.currentTarget);
    form = button.closest('form.register-form');
    return form.addClass('validation-start');
  };

  return LandgingController;

})();

$(document).ready(function() {
  return new LandgingController();
});

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkxhbmRnaW5nQ29udHJvbGxlci5jb2ZmZWUiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsSUFBQSxrQkFBQTtFQUFBLGtGQUFBOztBQUFBO0FBQ2UsRUFBQSw0QkFBQSxHQUFBO0FBQ1gsaURBQUEsQ0FBQTtBQUFBLCtDQUFBLENBQUE7QUFBQSwyQ0FBQSxDQUFBO0FBQUEsMkRBQUEsQ0FBQTtBQUFBLHFEQUFBLENBQUE7QUFBQSxtREFBQSxDQUFBO0FBQUEsaURBQUEsQ0FBQTtBQUFBLG1EQUFBLENBQUE7QUFBQSxJQUFBLElBQUMsQ0FBQSxLQUFELEdBQVMsT0FBVCxDQUFBO0FBQUEsSUFDQSxJQUFDLENBQUEsSUFBRCxHQUFRLENBQUEsQ0FBRSxNQUFGLENBRFIsQ0FBQTtBQUVBLElBQUEsSUFBRyxJQUFDLENBQUEsSUFBSSxDQUFDLFFBQU4sQ0FBZSxPQUFmLENBQUg7QUFDRSxNQUFBLElBQUMsQ0FBQSxLQUFELEdBQVMsWUFBVCxDQURGO0tBRkE7QUFBQSxJQUlBLElBQUMsQ0FBQSxJQUFELEdBQVEsQ0FBQSxDQUFFLGdCQUFGLENBSlIsQ0FBQTtBQUFBLElBS0EsSUFBQyxDQUFBLEtBQUQsR0FBUyxDQUFBLENBQUUsT0FBRixDQUxULENBQUE7QUFBQSxJQU1BLElBQUMsQ0FBQSxFQUFELEdBQU0sQ0FOTixDQUFBO0FBQUEsSUFPQSxNQUFNLENBQUMsV0FBUCxDQUFtQixJQUFDLENBQUEsV0FBcEIsRUFBaUMsSUFBakMsQ0FQQSxDQUFBO0FBQUEsSUFRQSxJQUFDLENBQUEsV0FBRCxDQUFBLENBUkEsQ0FBQTtBQUFBLElBVUEsSUFBQyxDQUFBLElBQUksQ0FBQyxJQUFOLENBQVcsV0FBWCxDQUF1QixDQUFDLElBQXhCLENBQTZCLGlCQUE3QixDQVZBLENBQUE7QUFBQSxJQVdBLElBQUMsQ0FBQSxJQUFJLENBQUMsSUFBTixDQUFXLFlBQVgsQ0FBd0IsQ0FBQyxJQUF6QixDQUE4QixRQUE5QixDQVhBLENBQUE7QUFBQSxJQWFBLENBQUEsQ0FB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LEtBQUssQ0FBQyxhQUFSLENBTFAsQ0FBQTtBQU1BLElBQUEsSUFBRyxJQUFJLENBQUMsSUFBTCxDQUFVLGVBQVYsQ0FBMEIsQ0FBQyxNQUEzQixLQUFtQyxDQUF0QztBQUNFLE1BQUEsQ0FBQyxDQUFDLElBQUYsQ0FBTyxJQUFJLENBQUMsSUFBTCxDQUFVLFFBQVYsQ0FBUCxFQUE0QixJQUFJLENBQUMsU0FBTCxDQUFBLENBQTVCLENBQTZDLENBQUMsUUFBOUMsQ0FBdUQsSUFBQyxDQUFBLFFBQXhELENBQUEsQ0FERjtLQU5BO0FBUUEsV0FBTyxLQUFQLENBVE07RUFBQSxDQXRGUixDQUFBOztBQUFBLCtCQWlHQSxRQUFBLEdBQVUsU0FBQyxRQUFELEdBQUE7QUFDUixJQUFBLElBQUMsQ0FBQSxJQUFJLENBQUMsSUFBTixDQUFBLENBQUEsQ0FBQTtXQUNBLElBQUMsQ0FBQSxPQUFPLENBQUMsSUFBVCxDQUFBLEVBRlE7RUFBQSxDQWpHVixDQUFBOztBQUFBLCtCQXFHQSxTQUFBLEdBQVcsU0FBQyxLQUFELEdBQUE7QUFDVCxRQUFBLFlBQUE7QUFBQSxJQUFBLE1BQUEsR0FBUyxDQUFBLENBQUUsS0FBSyxDQUFDLGFBQVIsQ0FBVCxDQUFBO0FBQUEsSUFDQSxJQUFBLEdBQU8sTUFBTSxDQUFDLE9BQVAsQ0FBZSxvQkFBZixDQURQLENBQUE7V0FFQSxJQUFJLENBQUMsUUFBTCxDQUFjLGtCQUFkLEVBSFM7RUFBQSxDQXJHWCxDQUFBOzs0QkFBQTs7SUFERixDQUFBOztBQUFBLENBMkdBLENBQUUsUUFBRixDQUFXLENBQUMsS0FBWixDQUFrQixTQUFBLEdBQUE7U0FDWixJQUFBLGtCQUFBLENBQUEsRUFEWTtBQUFBLENBQWxCLENBM0dBLENBQUEiLCJmaWxlIjoiTGFuZGdpbmdDb250cm9sbGVyLmpzIiwic291cmNlUm9vdCI6Ii9zb3VyY2UvIiwic291cmNlc0NvbnRlbnQiOlsiY2xhc3MgTGFuZGdpbmdDb250cm9sbGVyXG4gIGNvbnN0cnVjdG9yOiAtPlxuICAgIEBpdHlwZSA9ICdjbGljayc7XG4gICAgQGh0bWwgPSAkICdodG1sJ1xuICAgIGlmIEBodG1sLmhhc0NsYXNzKCd0b3VjaCcpXG4gICAgICBAaXR5cGUgPSAndG91Y2hzdGFydCdcbiAgICBAZm9ybSA9ICQoJy5yZWdpc3Rlci1mb3JtJylcbiAgICBAdGltZXIgPSAkKCcudGltZScpXG4gICAgQHRpID0gMFxuICAgIHdpbmRvdy5zZXRJbnRlcnZhbCBAdGltZXJVcGRhdGUsIDEwMDBcbiAgICBAdGltZXJVcGRhdGUoKVxuXG4gICAgQGZvcm0uZmluZCgnaW5wdXQudGVsJykubWFzayBcIig5OTkpIDk5OS05OS05OVwiXG4gICAgQGZvcm0uZmluZCgnaW5wdXQuY29kZScpLm1hc2sgXCIrOT85OTlcIlxuXG4gICAgJCgnLnJ1bGVzIC5jbG9zZScpLm9uIEBpdHlwZSwgQGNsb3NlUnVsZXNcbiAgICAkKCcuc2hvdy1ydWxlcycpLm9uIEBpdHlwZSwgQHNob3dSdWxlc1xuICAgIFxuICAgIEBtZXNzYWdlID0gdGhpcy5mb3JtLnByZXYoKVxuXG4gICAgQGxhbmcgPSAkICduYXYubGFuZ3VhZ2UnXG4gICAgQGxhbmcub24gdGhpcy5pdHlwZSwgQHNlbGVjdExhbmd1YWdlXG4gICAgQGxhbmcuZmluZCgnYScpLm9uIHRoaXMuaXR5cGUsIEBzZWxlY3RMYW5ndWFnZVxuXG4gICAgQGZvcm0uZmluZCgnYnV0dG9uJykub24gdGhpcy5pdHlwZSwgQHRyeXN1Ym1pdFxuICAgIEBmb3JtLm9uICdzdWJtaXQnLCBAc3VibWl0XG5cbiAgICBAbGFuZ3VhZ2UgPSBsb2NhbFN0b3JhZ2UubGFuZ3VhZ2UgfHwgbnVsbFxuXG5cbiAgICBpZiBAbGFuZ3VhZ2UgPT0gbnVsbFxuICAgICAgJC5nZXRKU09OKFwiaHR0cDovL3d3dy50ZWxpemUuY29tL2dlb2lwXCIsIEBpcDJDb3VudHJ5KVxuICAgIGVsc2UgaWYgQGxhbmd1YWdlID09ICdBWidcbiAgICAgIGNvbnNvbGUubG9nKCd0dXJuIG9uIEFaJylcbiAgICAgIEBsYW5nLnRyaWdnZXIodGhpcy5pdHlwZSlcblxuICBpcDJDb3VudHJ5OiAob2JqKT0+XG4gICAgc3dpdGNoIG9iai5jb3VudHJ5X2NvZGVcbiAgICAgIHdoZW4gJ0FaJyBcbiAgICAgICAgQGxhbmd1YWdlID0gJ0FaJ1xuICAgICAgICBAbGFuZy50cmlnZ2VyKHRoaXMuaXR5cGUpXG4gICAgICBlbHNlXG4gICAgICAgIEBsYW5ndWFnZSA9ICdSVSdcbiAgICBsb2NhbFN0b3JhZ2UubGFuZ3VhZ2UgPSBAbGFuZ3VhZ2VcblxuICBzaG93UnVsZXM6IChldmVudCk9PlxuICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KClcbiAgICBldmVudC5zdG9wUHJvcGFnYXRpb24oKVxuICAgIGlmIGV2ZW50Lmdlc3R1cmVcbiAgICAgIGV2ZW50Lmdlc3R1cmUuc3RvcFByb3BhZ2F0aW9uKClcbiAgICAgIGV2ZW50Lmdlc3R1cmUucHJldmVudERlZmF1bHQoKVxuICAgIEBodG1sLmFkZENsYXNzICdydWxlcydcbiAgICAkKGV2ZW50LmN1cnJlbnRUYXJnZXQpLmNsb3Nlc3QoJy5wYWdlJykuZmluZCgnLnJ1bGVzJykuc2hvdygpXG4gICAgd2luZG93LnNjcm9sbFRvIDAsIDBcbiAgICByZXR1cm4gZmFsc2VcblxuICBjbG9zZVJ1bGVzOiAoZXZlbnQpPT5cbiAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpXG4gICAgZXZlbnQuc3RvcFByb3BhZ2F0aW9uKClcbiAgICBpZiBldmVudC5nZXN0dXJlXG4gICAgICBldmVudC5nZXN0dXJlLnN0b3BQcm9wYWdhdGlvbigpXG4gICAgICBldmVudC5nZXN0dXJlLnByZXZlbnREZWZhdWx0KClcbiAgICBAaHRtbC5yZW1vdmVDbGFzcyAncnVsZXMnXG4gICAgJChldmVudC5jdXJyZW50VGFyZ2V0LnBhcmVudE5vZGUpLmhpZGUoKVxuICAgIHdpbmRvdy5zY3JvbGxUbyAwLCAwXG4gICAgcmV0dXJuIGZhbHNlXG5cbiAgdGltZXJVcGRhdGU6ID0+XG4gICAgaWYgKEB0aSUyKT09MFxuICAgICAgc2VwYXRvciA9IFwiOlwiXG4gICAgZWxzZVxuICAgICAgc2VwYXRvciA9IFwiwqBcIlxuICAgIEB0aSsrXG4gICAgQHRpbWVyLnRleHQobW9tZW50KCkuZm9ybWF0KFwiSEhcIitzZXBhdG9yK1wibW1cIikpXG5cbiAgc2VsZWN0TGFuZ3VhZ2U6IChldmVudCk9PlxuICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KClcbiAgICBldmVudC5zdG9wUHJvcGFnYXRpb24oKVxuICAgIGlmIGV2ZW50Lmdlc3R1cmVcbiAgICAgIGV2ZW50Lmdlc3R1cmUuc3RvcFByb3BhZ2F0aW9uKClcbiAgICAgIGV2ZW50Lmdlc3R1cmUucHJldmVudERlZmF1bHQoKVxuICAgIEBsYW5nLmZpbmQoJ2EnKS50b2dnbGVDbGFzcyAnc2VsZWN0ZWQnXG4gICAgQGxhbmd1YWdlID0gQGxhbmcuZmluZCgnLnNlbGVjdGVkJykuYXR0cignZGF0YS1sYW5nJylcbiAgICBsb2NhbFN0b3JhZ2UubGFuZ3VhZ2UgPSBAbGFuZ3VhZ2VcbiAgICBAaHRtbC5hdHRyICdsYW5nJywgQGxhbmd1YWdlXG4gICAgcmV0dXJuIGZhbHNlXG5cbiAgc3VibWl0OiAoZXZlbnQpPT5cbiAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpXG4gICAgZXZlbnQuc3RvcFByb3BhZ2F0aW9uKClcbiAgICBpZiBldmVudC5nZXN0dXJlXG4gICAgICBldmVudC5nZXN0dXJlLnN0b3BQcm9wYWdhdGlvbigpXG4gICAgICBldmVudC5nZXN0dXJlLnByZXZlbnREZWZhdWx0KClcbiAgICBmb3JtID0gJCBldmVudC5jdXJyZW50VGFyZ2V0XG4gICAgaWYgZm9ybS5maW5kKCdpbnB1dDppbnZhbGlkJykubGVuZ3RoPT0wXG4gICAgICAkLnBvc3QoZm9ybS5hdHRyKCdhY3Rpb24nKSwgZm9ybS5zZXJpYWxpemUoKSkuY29tcGxldGUoQGZvcm1TZW5kKVxuICAgIHJldHVybiBmYWxzZVxuXG4gIGZvcm1TZW5kOiAocmVzcG9uY2UpPT5cbiAgICBAZm9ybS5oaWRlKClcbiAgICBAbWVzc2FnZS5zaG93KClcblxuICB0cnlzdWJtaXQ6IChldmVudCk9PlxuICAgIGJ1dHRvbiA9ICQgZXZlbnQuY3VycmVudFRhcmdldFxuICAgIGZvcm0gPSBidXR0b24uY2xvc2VzdCgnZm9ybS5yZWdpc3Rlci1mb3JtJylcbiAgICBmb3JtLmFkZENsYXNzKCd2YWxpZGF0aW9uLXN0YXJ0JylcblxuJChkb2N1bWVudCkucmVhZHkgKCktPlxuICBuZXcgTGFuZGdpbmdDb250cm9sbGVyKCkiXX0=